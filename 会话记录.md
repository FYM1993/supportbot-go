# 会话记录 - 2024年12月18日

## 背景

用户：一个 Golang 后端工程师，在自学 Agent 项目，买的课程用 Java 实现。希望用 Go 重写项目，专注于 Agent 交互而不是学习 Java。

## 对话记录

### 1. 讲解 im-demo 服务

**用户**: 可以 很棒 现在环境以及搞定了 我昨天跟你学习了question-classifier这个服务 今天来学习im-demo吧

**助手**: 讲解了 im-demo 的架构、核心代码、面试考点。

### 2. 调整讲解方式

**用户**: 稍等 我强调下背景 我是一个后端工程师 在自学agent项目 想通过自学这个企业级实战的agent项目去找agent相关的工作 所以在回答问题的时候可以多偏向面试会提问的问题及知识点

**助手**: 调整为面试导向，边讲解代码边标注面试考点。

### 3. 调整讲解方式（再次）

**用户**: 额 我的意思是这样 你不是讲解了这个im-demo的架构 然后详解核心代码么 在讲解架构和核心代码的时候带上面试要点 这样把讲解项目和准备面试兼顾

**助手**: 重新组织，**边讲解代码边标注面试考点**，让学习和面试准备一步到位。

### 4. 提出用 Go 重写

**用户**: 我再补充下 我是一个golang的后端开发工程师 只是因为买的课用的java 如果你能把这个项目用golang改造下最好了 我只用专注于agent的交互不需要考虑学习语言了 因为就几周就出去面java的话 java很多知识点我肯定不知道

**助手**: 提供了详细的 Golang 技术栈选型和实现方案。

### 5. 开始重写项目

**用户**: 你能把supportBot这个项目都用golang全部重写么 直接生成一个新的项目

**助手**: 开始创建 supportbot-go 项目，包括：
- 项目结构搭建
- 核心服务实现（im-demo, question-classifier, assistant, general-chat, knowledge-rag）
- 配置文件
- 启动脚本
- 文档（README, QUICKSTART）

### 6. 升级 Go 版本

**用户**: 升级go版本 我有goenv管理的 你直接切换就行

**助手**: 使用 goenv 切换到 Go 1.21，后因依赖要求自动切换到 1.24.11

### 7. 修复编译错误

过程中修复了：
- 访问私有字段的问题（添加 WriteMessage 方法）
- 缺少 import 的问题
- zap 日志调用错误

最终所有服务编译成功！

## 项目成果

### 创建的项目：supportbot-go

位置: `/Users/yimin.fu/JavaProjects/supportbot-go`

### 服务列表

1. **im-demo** (11005) - WebSocket 网关
2. **question-classifier** (11001) - 问题分类
3. **assistant** (11002) - 业务助手
4. **general-chat** (11003) - 通用对话
5. **knowledge-rag** (11004) - 知识库

### 关键文件

- `README.md` - 详细文档
- `QUICKSTART.md` - 快速入门
- `start.sh` / `stop.sh` - 启动/停止脚本
- `Makefile` - 构建工具
- `configs/*.yaml` - 配置文件

## 下一步

1. 配置 API Key（通义千问）
2. 启动 Redis
3. 运行服务测试
4. 学习核心代码，准备面试

## 核心面试考点（已讲解）

1. WebSocket vs HTTP 轮询
2. 双向索引设计（userSessions + sessionToUser）
3. 并发安全（sync.RWMutex）
4. 心跳检测机制
5. 异步回调模式
6. STOMP 协议
7. 会话管理的重复连接处理
8. convertAndSendToUser 实现原理

## 技术栈

- Golang 1.24.11
- Gin (Web 框架)
- gorilla/websocket
- go-redis
- zap (日志)
- 通义千问（DashScope）

